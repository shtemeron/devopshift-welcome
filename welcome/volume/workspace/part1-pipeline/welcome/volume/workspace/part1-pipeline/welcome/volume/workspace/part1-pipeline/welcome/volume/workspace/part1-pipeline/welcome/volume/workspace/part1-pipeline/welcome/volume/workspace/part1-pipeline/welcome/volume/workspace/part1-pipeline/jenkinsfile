pipeline {
    agent any

    environment {
        IMAGE_NAME='docker-ex1-jenkins'
        VERSION="v${env.BUILD_NUMBER}"
        REPO='shtemeron/jenkins-project'
        CREDENTIALS_ID='docker-credentials'
    }

    stages {
        
        stage('Build') {
            steps {
                //Build the Docker image for the build stage
                   sh 'cd /home/ubuntu/workarea/repo/welcome/app/bookinfo/src/productpage'
                   sh "docker build --target build --tag ${IMAGE_NAME}:${VERSION} ."
            }
        }
    }    
}